---
title:  Word VBAæ’ç‰ˆå‚æ•°æ¡ˆä¾‹
date: 2025-3-5 19:08:33
tags: ç¨‹åº
categories: 
- ç”µè„‘
- æŠ€æœ¯
---

# Word VBAæ’ç‰ˆå‚æ•°æ¡ˆä¾‹ 



- <font style="background-color:#8bc34a">2025å¹´3æœˆ5æ—¥</font>ï¼›<font title="yellow">æ˜ŸæœŸä¸‰</font> ï¼›<font title="blue">å¤šäº‘</font>

| åºå· |  ä½œè€…   | åœºæ™¯ç±»å‹ |
| :--: | :-----: | :------: |
|  1   | **æˆ‘**ğŸ˜€ | ç”µè„‘æŠ€æœ¯ |

<span alt="shake">ä»Šæ—¥æ„Ÿå—ï¼š</span>

<div alt="timeline">
    <div alt="timenode">
        <div alt="meta"><span alt="btn">ä¸Šåˆ</span><a href="#">ï¼š</a></div>
        <div alt="body">
            åˆå›°åˆç´¯ã€‚
        </div>
    </div>
    <div alt="timenode">
        <div alt="meta"><span alt="btn">ä¸‹åˆ</span><a href="#">ï¼š</a></div>
        <div alt="body">
            æ˜å¤©é‡è¦ä¼šè®®ã€‚
        </div>
    </div>
</div>
------------------------------------------------------------------------------------------------------------------------------------------------------------------

ä¸€ã€ä¿®æ”¹æ ‡é¢˜æ ·å¼ï¼ˆ1ã€2ã€3...çº§æ ‡é¢˜ï¼‰

  ä»¥1çº§æ ‡é¢˜ä¸ºä¾‹ï¼Œé¦–å…ˆæ‰¾åˆ°ç±»å‹ä¸ºâ€œæ ‡é¢˜ 1â€çš„æ ·å¼æ®µè½ï¼Œå†ä¿®æ”¹å…¶å…·ä½“æ ·å¼ï¼Œå¦‚åŠ ç²—ã€ä¸‹åˆ’çº¿ã€å€¾æ–œã€è¡Œè·ã€æ®µå‰æ®µåç­‰ã€‚å®ç°ä»£ç å¦‚ä¸‹ï¼š

```js
Sub FormatHeading2()   'ä¿®æ”¹1çº§æ ‡é¢˜
    Dim p As Paragraph
    For Each p In ActiveDocument.Paragraphs
        If p.Style = ActiveDocument.styles("æ ‡é¢˜ 1") Then
            p.Range.Font.Bold = True
            p.Range.Font.Italic = True 'è®¾ç½®å€¾æ–œ
            p.Range.Font.Underline = wdUnderlineSingle 'è®¾ç½®ä¸‹åˆ’çº¿ï¼ˆå•ä¸‹åˆ’çº¿ï¼‰            
            p.Range.Font.Size = 15
            p.Range.Font.name = "å®‹ä½“"
            p.Range.ParagraphFormat.Alignment = wdAlignParagraphRight
            p.Range.ParagraphFormat.spaceBefore = 20
            p.Range.ParagraphFormat.spaceAfter = 10
            p.Range.ParagraphFormat.LineSpacingRule = wdLineSpaceSingle   'å•å€è¡Œè·
            p.Range.ParagraphFormat.CharacterUnitFirstLineIndent = 0
            p.Range.ParagraphFormat.FirstLineIndent = CentimetersToPoints(0)
        End If
    Next p
End Sub
```


å…¶ä»–æ›´å¤šè¯¦ç»†çš„å±æ€§å¯è‡ªè¡ŒæŸ¥é˜…å¼€å‘æ–‡æ¡£ã€‚

äºŒã€ä¿®æ”¹ç›®å½•å†…å®¹æ ·å¼

â€‹    å¯¹äºç›®å½•ä¸­ä¸åŒçº§åˆ«çš„æ ‡é¢˜çš„æ ·å¼ä¼šå­˜åœ¨å·®å¼‚ï¼Œæˆ‘æŸ¥æ‰¾å¹¶ä¿®æ”¹æ ·å¼çš„è¿‡ç¨‹æ˜¯ï¼Œå…ˆæ‰¾åˆ°æ‰€æœ‰æ ‡é¢˜çš„åç§°ï¼Œä¸åŒçº§åˆ«æ”¾å…¥ä¸åŒæ•°ç»„ä¸­ï¼Œåœ¨æ¯ä¸ªæ•°ç»„éå†å¯»æ‰¾ç¬¬ä¸€æ¬¡å‡ºç°çš„æ®µè½ä¿®æ”¹å…¶æ ·å¼ã€‚æ³¨æ„æ³¨æ„ï¼šç›®å½•ä¸­çš„æ–‡æœ¬å±äºè¶…é“¾æ¥æ–‡æœ¬ï¼å®ç°ä»£ç å¦‚ä¸‹ï¼ˆä»¥ä¿®æ”¹ç›®å½•ä¸­1çº§æ ‡é¢˜ä¸ºä¾‹ï¼‰ï¼š

```js
Sub updateDirectoryContentOneStyle()        'æ³¨æ„è¶…é“¾æ¥æ–‡æœ¬é—®é¢˜
    Dim p As Paragraph
    Dim one() As String
    Dim oneCount As Integer
    Dim i As Integer
  For Each p In ActiveDocument.Paragraphs
    If p.Style = ActiveDocument.styles("æ ‡é¢˜ 1") Then
        ReDim Preserve one(oneCount) 'æ‰©å±•ä¸€çº§æ ‡é¢˜æ•°ç»„
        one(oneCount) = p.Range.text
        oneCount = oneCount + 1
    End If
  Next p

'è¾“å‡ºæ•°ç»„ä¸­ä¿å­˜çš„æ ‡é¢˜å†…å®¹
  For i = 0 To UBound(one)
    Dim myRange As Range
    Dim myStyle As Style
    Set myRange = ActiveDocument.Content
    
    myRange.Find.Execute FindText:=one(i), Forward:=True  'æŸ¥æ‰¾
    
    If myRange.Find.Found = True Then
        With myRange
            .Font.Bold = False
            .Font.name = "å®‹ä½“"
            .Font.Size = 14
        End With
    End If
  Next
End Sub
```

ä¸‰ã€æŸ¥æ‰¾ç‰¹å®šæ–‡æœ¬å¹¶ä¿®æ”¹å…¶æ ·å¼

 æœ¬æ–‡ä»¥æŸ¥æ‰¾â€œå…³é”®è¯â€ä¸‰å­—ä¸ºä¾‹ã€‚ä½¿ç”¨Findå…³é”®å­—è¿›è¡ŒæŸ¥æ‰¾ï¼Œæ‰¾åˆ°åä¿®æ”¹å…¶æ ·å¼å³å¯ã€‚æ›´å¤šçš„è¯¦ç»†å±æ€§è¯·å‚è€ƒå¼€å‘æ–‡æ¡£ï¼Œå®ç°ä»£ç å¦‚ä¸‹ï¼š

```js
Sub findText()
    Set myRange = ActiveDocument.Content
    myRange.Find.Execute FindText:="å…³é”®è¯", Forward:=True
    If myRange.Find.Found = True Then
        With myRange
            .Font.Bold = False
            .ParagraphFormat.Alignment = wdAlignParagraphLeft 'å·¦å¯¹é½
            .Font.Color = wdColorBlack
            .Font.name = "é»‘ä½“"
            .Font.Size = 14
            .ParagraphFormat.PageBreakBefore = False
            .ParagraphFormat.CharacterUnitFirstLineIndent = 0   'å»é™¤é¦–è¡Œç¼©è¿›
            .ParagraphFormat.FirstLineIndent = CentimetersToPoints(0)
        End With
    End If
End Sub
```

å››ã€è¡¨æ ¼æ ·å¼

â€‹    ä¿®æ”¹è¡¨æ ¼æ ·å¼ï¼Œå¯ä»¥æŸ¥é˜…å¼€å‘æ–‡æ¡£ä¸ç½‘ç»œèµ„æºã€‚æˆ‘ä¹Ÿå‚è€ƒäº†AIçš„ä¸€äº›ä»£ç ã€‚å®ç°ä»£ç å¦‚ä¸‹ï¼ˆæœ€åŸºæœ¬çš„ä¸åŠ æ ·å¼çš„è¡¨æ ¼ï¼‰ï¼š

```
Sub execlOperate()   'è¡¨æ ¼æ ·å¼æ“ä½œ
    Application.ScreenUpdating = False  'å…³é—­å±å¹•åˆ·æ–°
    Application.DisplayAlerts = False
    On Error Resume Next  'å¿½ç•¥é”™è¯¯
    Dim mytable As Table, i As Long
    If Selection.Information(wdWithInTable) = True Then i = 1
    For Each mytable In ActiveDocument.Tables
        If i = 1 Then Set mytable = Selection.Tables(1)
        With mytable
            'å–æ¶ˆåº•è‰²
            .Shading.ForegroundPatternColor = wdColorAutomatic
            .Shading.BackgroundPatternColor = wdColorAutomatic
            Options.DefaultHighlightColorIndex = wdNoHighlight
            .Range.HighlightColorIndex = wdNoHighlight
            .Style = "è¡¨æ ¼ä¸»é¢˜"
       'å•å…ƒæ ¼è¾¹è·
        .TopPadding = PixelsToPoints(0, True) 'è®¾ç½®ä¸Šè¾¹è·ä¸º0
        .BottomPadding = PixelsToPoints(0, True) 'è®¾ç½®ä¸‹è¾¹è·ä¸º0
        .LeftPadding = PixelsToPoints(0, True)  'è®¾ç½®å·¦è¾¹è·ä¸º0
        .RightPadding = PixelsToPoints(0, True) 'è®¾ç½®å³è¾¹è·ä¸º0
        .Spacing = PixelsToPoints(0, True) 'å…è®¸å•å…ƒæ ¼é—´è·ä¸º0
        .AllowPageBreaks = True               'å…è®¸æ–­é¡µ
        '.AllowAutoFit = True                 'å…è®¸è‡ªåŠ¨è°ƒæ•´å°ºå¯¸
        
        'è®¾ç½®è¾¹æ¡†
        .Borders(wdBorderLeft).LineStyle = wdLineStyleNone
        .Borders(wdBorderRight).LineStyle = wdLineStyleNone
        .Borders(wdBorderTop).LineStyle = wdLineStyleNone
        .Borders(wdBorderBottom).LineStyle = wdLineStyleNone
        .Borders(wdBorderTop).LineStyle = wdLineStyleThinThickMedGap
        .Borders(wdBorderTop).LineWidth = wdLineWidth2pt
        .Borders(wdBorderBottom).LineStyle = wdLineStyleThickThinMedGap
        .Borders(wdBorderBottom).LineWidth = wdLineWidth225pt
        
        With .Rows
            .WrapAroundText = False 'å–æ¶ˆæ–‡å­—ç¯ç»•
            .Alignment = wdAlignRowCenter 'è¡¨æ°´å¹³å±…ä¸­  wdAlignRowLeft 'å·¦å¯¹é½
            .AllowBreakAcrossPages = False 'ä¸å…è®¸è¡Œæ–­é¡µ
            .HeightRule = wdRowHeightExactly 'è¡Œé«˜è®¾ä¸ºæœ€å°å€¼   wdRowHeightAuto 'è¡Œé«˜è®¾ä¸ºè‡ªåŠ¨
            .Height = CentimetersToPoints(0) 'ä¸Šé¢ç¼©è¿›é‡ä¸º0
            .LeftIndent = CentimetersToPoints(0) 'å·¦é¢ç¼©è¿›é‡ä¸º0
        End With
        
        With .Range
            With .Font 'å­—ä½“æ ¼å¼
                .name = "å®‹ä½“"
                .name = "Times New Roman"
                .Color = wdColorAutomatic 'è‡ªåŠ¨å­—ä½“é¢œè‰²
                .Size = 12
                .Kerning = 0
                .DisableCharacterSpaceGrid = True
            End With
            
            With .ParagraphFormat 'æ®µè½æ ¼å¼
                .CharacterUnitFirstLineIndent = 0 'å–æ¶ˆé¦–è¡Œç¼©è¿›
                .FirstLineIndent = CentimetersToPoints(0) 'å–æ¶ˆé¦–è¡Œç¼©è¿›
                .LineSpacingRule = wdLineSpaceSingle 'å•å€è¡Œè·  wdLineSpaceExactly 'è¡Œè·å›ºå®šå€¼
                '.LineSpacing = 20 'è®¾ç½®è¡Œé—´è·ä¸º20ç£…ï¼Œé…åˆè¡Œè·å›ºå®šå€¼
                .Alignment = wdAlignParagraphCenter 'å•å…ƒæ ¼æ°´å¹³å±…ä¸­
                .AutoAdjustRightIndent = False
                .DisableLineHeightGrid = True
            End With
            
            .Cells.VerticalAlignment = wdCellAlignVerticalCenter  'å•å…ƒæ ¼å‚ç›´å±…ä¸­
            
        End With
        
        'è®¾ç½®é¦–è¡Œæ ¼å¼
        .Cell(1, 1).Select ' é€‰ä¸­ç¬¬ä¸€ä¸ªå•å…ƒæ ¼
        With Selection
            .SelectRow 'é€‰ä¸­å½“å‰è¡Œ
            Selection.Rows.HeadingFormat = wdToggle 'è‡ªåŠ¨æ ‡é¢˜è¡Œé‡å¤
            .Range.Font.Bold = False 'è¡¨å¤´åŠ ç²—é»‘ä½“
            .Shading.ForegroundPatternColor = wdColorAutomatic 'é¦–è¡Œè‡ªåŠ¨é¢œè‰²
            '.Shading.BackgroundPatternColor = -603923969 'é¦–è¡Œåº•çº¹å¡«å……
        End With
        
        'è‡ªåŠ¨è°ƒæ•´è¡¨æ ¼
        .Columns.PreferredWidthType = wdPreferredWidthAuto
        .AutoFitBehavior (wdAutoFitContent) 'æ ¹æ®å†…å®¹è°ƒæ•´è¡¨æ ¼
        .AutoFitBehavior (wdAutoFitWindow) 'æ ¹æ®çª—å£è°ƒæ•´è¡¨æ ¼
        
    End With
    
    If i = 1 Then Exit For
  Next
  Err.Clear: On Error GoTo 0             'æ¢å¤é”™è¯¯æ•æ‰
  Application.DisplayAlerts = True       'å¼€å¯æç¤º
  Application.ScreenUpdating = True      'å¼€å¯å±å¹•åˆ·æ–°
End Sub
```

â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”

![](../pic/grass.jpg)
